syntax = "proto3";

option java_package = "com.pjtsearch.opencontroller_lib_proto";
option java_multiple_files = true;
option go_package = "pjtsearch.com/opencontroller_lib_proto";

package model;

message House {
  string display_name = 1;
  string id = 2;
  repeated Room rooms = 3;
  repeated Device devices = 4;
}

message Room {
  string display_name = 1;
  string id = 2;
  repeated Controller controllers = 3;
}

message Controller {
  string display_name = 1;
  string id = 2;
  repeated Widget widgets = 3;
}

message Device {
  string id = 1;
  repeated Func funcs = 2;
}

message Widget {
  oneof inner {
    Button button = 1;
    Row row = 3;
    Column column = 4;
    ArrowLayout arrow_layout = 5;
    Space space = 6;
    TextInput text_input = 7;
  }
}

message Button {
  Func func = 1;
  string text = 3;
  oneof optional_icon {
    Icon icon = 2;
  }
}

message Row {
  repeated Widget children = 1;
}

message Column {
  repeated Widget children = 1;
}

message ArrowLayout {
  Widget top = 1;
  Widget bottom = 2;
  Widget left = 3;
  Widget right = 4;
  Widget center = 5;
}

message TextInput {
  Func func = 1;
  string text = 3;
  oneof optional_icon {
    Icon icon = 2;
  }
}

message Space {}

message Func {
  string id = 1;
  repeated string args = 2;
  oneof inner {
    HttpFunc http_func = 3;
    TCPFunc tcp_func = 4;
    MacroFunc macro_func = 5;
    DelayFunc delay_func = 6;
    RefFunc ref_func = 7;
    ConcatenateFunc concatenate_func = 8;
    PushStackFunc push_stack_func = 9;
    StringFunc string_func = 10;
    PipeFunc pipe_func = 11;
  }
}

message HttpFunc {
  oneof url_inner {
    string url = 1;
    Func url_script = 2;
  }
  HttpMethod method = 3;
}

enum HttpMethod {
    GET = 0;
    HEAD = 1;
    POST = 2;
    PUT = 3;
    PATCH = 4;
    DELETE = 5;
}

message TCPFunc {
  string address = 1;
  oneof command_inner {
    string command = 2;
    Func command_script = 3;
  }
}

message MacroFunc {
  repeated Func funcs = 1;
}

message PipeFunc {
  repeated Func funcs = 1;
}

message DelayFunc {
  int32 time = 1;
}

message RefFunc {
  string device = 1;
  string func = 2;
}

message StringFunc {
  string string = 1;
}

message PushStackFunc {
  Func func = 1;
}

message ConcatenateFunc {}

enum Icon {
  STAR = 0;
  ARROW_UP = 1;
  ARROW_DOWN = 2;
  ARROW_LEFT = 3;
  ARROW_RIGHT = 4;
  SELECT = 5;
  VOLUME_UP = 6;
  VOLUME_DOWN = 7;
  VOLUME_MUTE = 8;
  BACK = 9;
  ON = 10;
  OFF = 11;
  FORWARD = 12;
  REVERSE = 13;
  INFO = 14;
  HOME = 15;
  CHANNEL_UP = 16;
  CHANNEL_DOWN = 17;
  CHANNEL = 18;
  REMOVE = 19;
  STOP = 20;
  SKIP_FORWARD = 21;
  SKIP_REVERSE = 22;
  RECORD = 23;
  PAUSE = 24;
  PLAY = 25;
  GUIDE = 26;
  DVR = 27;
  MENU = 28;
  OPTIONS = 29;
  EXIT = 30;
  ASTERISK = 31;
  POUND = 32;
}